"use strict";function LogoutCtrl(e,t){t.logout().then(function(){e.go("app")})}LogoutCtrl.$inject=["$state","AuthService"],angular.module("bonsaiManagerWebApp",["ngResource","ngDialog","ui.router","lbServices","nvd3"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/",views:{sidebar:{templateUrl:"views/sidebar.html",controller:"SidebarCtrl",controllerAs:"sidebar"},content:{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}}}).state("app.newedit",{url:"newedit/:id",views:{"content@":{templateUrl:"views/newedit.html",controller:"NewEditCtrl",controllerAs:"newedit"}}}).state("app.list",{url:"list",views:{"content@":{templateUrl:"views/list.html",controller:"ListCtrl",controllerAs:"list"}}}).state("app.bonsaidetail",{url:"detail/:id",views:{"content@":{templateUrl:"views/bonsaidetail.html",controller:"BonsaiDetailCtrl",controllerAs:"detail"}}}),t.otherwise("/")}]).config(["$httpProvider",function(e){e.interceptors.push(function(){return{request:function(e){return"/"===e.url.charAt(0)&&(e.url="https://bonsai-manager.mybluemix.net"+e.url,console.log("interceptor req url: ",e.url),e.withCredentials=!0),e}}})}]).run(["$rootScope","$state","LoopBackAuth","AuthService",function(e,t,r,n){e.$on("$stateChangeStart",function(n,s,o){s.authenticate&&!r.accessTokenId&&(n.preventDefault(),e.returnTo={state:s,params:o},t.go("app"))}),r.accessTokenId&&!e.currentUser&&n.refresh(r.accessTokenId)}]),function(){function e(e,t,r,n,s,o){function i(){l.loggedIn=!1,l.username="",o.isAuthenticated()&&(l.loggedIn=!0,l.username=o.getUsername())}function a(){s.open({template:"views/login.html",scope:e,className:"ngdialog-theme-default",controller:"LoginCtrl"})}function d(){o.logout(),l.loggedIn=!1,l.username=""}function u(e){return t.is(e)}var l=this;l.openLogin=a,l.logOut=d,l.stateis=u,r.$on("login:Successful",function(){l.loggedIn=o.isAuthenticated(),l.username=o.getUsername()}),r.$on("registration:Successful",function(){l.loggedIn=o.isAuthenticated(),l.username=o.getUsername()}),e.$watch("currentUser.id",function(e){e&&(console.log("value",e),l.loggedIn=!0,l.username=o.getUsername())}),i()}e.$inject=["$scope","$state","$rootScope","$log","ngDialog","AuthService"],angular.module("bonsaiManagerWebApp").controller("SidebarCtrl",e)}(),function(){function e(e,t,r,n,s,o,i,a){function d(){p.options={chart:{type:"pieChart",height:300,x:function(e){return e.key},y:function(e){return e.y},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}}}}}function u(e){return console.log("index",e),p.bonsais.length>=0?p.bonsais.length:e}function l(){o.open({template:"views/login.html",scope:e,className:"ngdialog-theme-default",controller:"LoginCtrl"})}function c(e){console.log("bonsai id",e),e&&r.go("app.bonsaidetail",{id:e})}var p=this;p.openLogin=l,p.bonsaiDetail=c,p.getSecondIndex=u,t.$on("login:Successful",function(){p.loggedIn=a.isAuthenticated(),p.username=a.getUsername()}),t.$on("logout",function(){p.loggedIn=!1,p.username=""}),e.$watch("currentUser.id",function(e){e&&(console.log("value",e),p.loggedIn=!0,i.bonsais({id:"me"}).$promise.then(function(e){if(p.bonsais=e,console.log("bonsais",p.bonsais),p.data=[],p.bonsais&&p.bonsais.length>0){var t=p.bonsais.reduce(function(e,t){return e[t.species]=(e[t.species]||0)+1,e},{});angular.forEach(t,function(e,t){console.log(t+": "+e.species),p.data.push({key:n("limitTo")(t,10),y:e})}),s.info("result",t);var r=0;angular.forEach(p.bonsais,function(e,t){r+=e.age}),p.meanAge=r/p.bonsais.length,s.info("mean age",p.meanAge)}},function(e){p.message="Error: "+e.status+" "+e.statusText}))}),d()}e.$inject=["$scope","$rootScope","$state","$filter","$log","ngDialog","User","AuthService"],angular.module("bonsaiManagerWebApp").controller("MainCtrl",e)}(),function(){function e(e,t,r,n,s,o,i,a){function d(){e.loggedIn=!1,e.username="",e.loginData=i.getObject("userinfo","{}"),console.log("user",e.loginData),e.loginData&&(e.loggedIn=!0)}e.facebookLogin=r,e.googleLogin=n,e.twitterLogin=s,e.doLogin=function(){console.log("login"),e.rememberMe&&i.storeObject("userinfo",e.loginData),a.login(e.loginData),o.close()},e.openRegister=function(){console.log("register"),o.open({template:"views/register.html",scope:e,className:"ngdialog-theme-default",controller:"RegisterCtrl"})},d()}e.$inject=["$scope","$user","$facebookLogin","$googleLogin","$twitterLogin","ngDialog","$localStorage","AuthService"],angular.module("bonsaiManagerWebApp").controller("LoginCtrl",e)}(),angular.module("bonsaiManagerWebApp").controller("LogoutCtrl",LogoutCtrl),function(){function e(e,t,r,n){e.doRegister=function(){console.log("regoister",e.registration),t.register(e.registration),r.close()}}e.$inject=["$scope","AuthService","ngDialog","$localStorage"],angular.module("bonsaiManagerWebApp").controller("RegisterCtrl",e)}(),function(){function e(e,t,r,n,s,o,i){function a(){l.loggedIn=!1,l.editMode=!1,i.isAuthenticated()&&s.id&&o.findById({id:s.id}).$promise.then(function(e){l.bonsai=e,l.editMode=!0},function(e){l.message="Error: "+e.status+" "+e.statusText})}function d(){l.editMode?(r.info("update",l.bonsai),o.upsert(l.bonsai).$promise.then(function(e){r.info("bonsai saved",e),n.go("app.list")})):(r.info("create",l.bonsai),o.create(l.bonsai).$promise.then(function(e){r.info("bonsai saved",e),n.go("app.list")}))}function u(){n.go("app.list")}var l=this;l.createUpdateBonsai=d,l.cancel=u,t.$on("login:Successful",function(){l.loggedIn=i.isAuthenticated(),l.username=i.getUsername()}),t.$on("logout",function(){l.loggedIn=!1,l.username=""}),e.$watch("currentUser.id",function(e){e&&(l.loggedIn=!0)}),a()}e.$inject=["$scope","$rootScope","$log","$state","$stateParams","Bonsai","AuthService"],angular.module("bonsaiManagerWebApp").controller("NewEditCtrl",e)}(),function(){function e(e,t,r,n,s,o,i){function a(){}function d(){o.openConfirm({template:'<p>Are you sure you want to delete selected Bonsai?</p><div><button type="button" class="btn btn-default" ng-click="closeThisDialog(0)">No&nbsp;<button type="button" class="btn btn-primary pull-right" ng-click="confirm(1)">Yes</button></div>',plain:!0,className:"ngdialog-theme-default"}).then(function(e){console.log("create",u.bonsai),s["delete"](u.bonsai).$promise.then(function(e){console.log("bonsai deleted",e),r.go("app.list")})},function(e){})}var u=this;u.deleteBonsai=d,t.$watch("currentUser.id",function(e){e&&(u.loggedIn=!0,s.findById({id:n.id}).$promise.then(function(e){u.bonsai=e,console.log("bonsai",u.bonsai)},function(e){u.message="Error: "+e.status+" "+e.statusText}))}),a()}e.$inject=["$rootScope","$scope","$state","$stateParams","Bonsai","ngDialog","AuthService"],angular.module("bonsaiManagerWebApp").controller("BonsaiDetailCtrl",e)}(),function(){function e(e,t,r,n){function s(){i.loggedIn=!1,i.username="",n.isAuthenticated()&&(i.loggedIn=!0,i.username=n.getUsername(),console.log("currentUser",i.username))}function o(e){console.log("bonsai id",e),e&&$state.go("app.bonsaidetail",{id:e})}var i=this;i.bonsaiDetail=o,e.$on("login:Successful",function(){i.loggedIn=n.isAuthenticated(),i.username=n.getUsername()}),e.$on("logout",function(){i.loggedIn=!1,i.username=""}),t.$watch("currentUser.id",function(t){t&&(i.loggedIn=!0,console.log("value",e.currentUser),r.bonsais({id:"me"}).$promise.then(function(e){i.bonsais=e,console.log("bonsais",i.bonsais)},function(e){i.message="Error: "+e.status+" "+e.statusText}))}),s()}e.$inject=["$rootScope","$scope","User","AuthService"],angular.module("bonsaiManagerWebApp").controller("ListCtrl",e)}(),function(){angular.module("bonsaiManagerWebApp").directive("loader",["$rootScope",function(e){return function(e,t,r){return e.$on("loader_show",function(){return t.show()}),e.$on("loader_hide",function(){return t.hide()})}}])}(),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="lbServices"),function(e,t,r){function n(e){var t=e.match(/^(?:https?:)?\/\/([^\/]+)/);return t?t[1]:null}var s="/api",o="authorization",i=n(s)||location.host,a=t.module("lbServices",["ngResource"]);a.factory("User",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,n){var o=e(s+"/Users/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:s+"/Users/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:s+"/Users/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:s+"/Users/:id/accessTokens/:fk",method:"PUT"},prototype$__findById__identities:{params:{fk:"@fk"},url:s+"/Users/:id/identities/:fk",method:"GET"},prototype$__destroyById__identities:{params:{fk:"@fk"},url:s+"/Users/:id/identities/:fk",method:"DELETE"},prototype$__updateById__identities:{params:{fk:"@fk"},url:s+"/Users/:id/identities/:fk",method:"PUT"},prototype$__findById__credentials:{params:{fk:"@fk"},url:s+"/Users/:id/credentials/:fk",method:"GET"},prototype$__destroyById__credentials:{params:{fk:"@fk"},url:s+"/Users/:id/credentials/:fk",method:"DELETE"},prototype$__updateById__credentials:{params:{fk:"@fk"},url:s+"/Users/:id/credentials/:fk",method:"PUT"},prototype$__findById__bonsais:{params:{fk:"@fk"},url:s+"/Users/:id/bonsais/:fk",method:"GET"},prototype$__destroyById__bonsais:{params:{fk:"@fk"},url:s+"/Users/:id/bonsais/:fk",method:"DELETE"},prototype$__updateById__bonsais:{params:{fk:"@fk"},url:s+"/Users/:id/bonsais/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:s+"/Users/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:s+"/Users/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:s+"/Users/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:s+"/Users/:id/accessTokens/count",method:"GET"},prototype$__get__identities:{isArray:!0,url:s+"/Users/:id/identities",method:"GET"},prototype$__create__identities:{url:s+"/Users/:id/identities",method:"POST"},prototype$__delete__identities:{url:s+"/Users/:id/identities",method:"DELETE"},prototype$__count__identities:{url:s+"/Users/:id/identities/count",method:"GET"},prototype$__get__credentials:{isArray:!0,url:s+"/Users/:id/credentials",method:"GET"},prototype$__create__credentials:{url:s+"/Users/:id/credentials",method:"POST"},prototype$__delete__credentials:{url:s+"/Users/:id/credentials",method:"DELETE"},prototype$__count__credentials:{url:s+"/Users/:id/credentials/count",method:"GET"},prototype$__get__bonsais:{isArray:!0,url:s+"/Users/:id/bonsais",method:"GET"},prototype$__create__bonsais:{url:s+"/Users/:id/bonsais",method:"POST"},prototype$__delete__bonsais:{url:s+"/Users/:id/bonsais",method:"DELETE"},prototype$__count__bonsais:{url:s+"/Users/:id/bonsais/count",method:"GET"},create:{url:s+"/Users",method:"POST"},createMany:{isArray:!0,url:s+"/Users",method:"POST"},patchOrCreate:{url:s+"/Users",method:"PATCH"},replaceOrCreate:{url:s+"/Users/replaceOrCreate",method:"POST"},upsertWithWhere:{url:s+"/Users/upsertWithWhere",method:"POST"},exists:{url:s+"/Users/:id/exists",method:"GET"},findById:{url:s+"/Users/:id",method:"GET"},replaceById:{url:s+"/Users/:id/replace",method:"POST"},find:{isArray:!0,url:s+"/Users",method:"GET"},findOne:{url:s+"/Users/findOne",method:"GET"},updateAll:{url:s+"/Users/update",method:"POST"},deleteById:{url:s+"/Users/:id",method:"DELETE"},count:{url:s+"/Users/count",method:"GET"},prototype$patchAttributes:{url:s+"/Users/:id",method:"PATCH"},createChangeStream:{url:s+"/Users/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(e){var r=e.data;return t.setUser(r.id,r.userId,r.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:s+"/Users/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource},responseError:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:s+"/Users/logout",method:"POST"},prototype$verify:{url:s+"/Users/:id/verify",method:"POST"},confirm:{url:s+"/Users/confirm",method:"GET"},resetPassword:{url:s+"/Users/reset",method:"POST"},changePassword:{url:s+"/Users/change-password",method:"POST"},setPassword:{url:s+"/Users/reset-password",method:"POST"},"::get::UserCredential::user":{url:s+"/UserCredentials/:id/user",method:"GET"},"::get::UserIdentity::user":{url:s+"/UserIdentities/:id/user",method:"GET"},getCurrent:{url:s+"/Users/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource},responseError:function(e){return t.clearUser(),t.clearStorage(),n.reject(e)}},__isGetCurrentUser__:!0}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.getCachedCurrent=function(){var e=t.currentUserData;return e?new o(e):null},o.isAuthenticated=function(){return null!=this.getCurrentId()},o.getCurrentId=function(){return t.currentUserId},o.modelName="User",o.identities=function(){var e=r.get("UserIdentity"),t=e["::get::User::identities"];return t.apply(o,arguments)},o.identities.count=function(){var e=r.get("UserIdentity"),t=e["::count::User::identities"];return t.apply(o,arguments)},o.identities.create=function(){var e=r.get("UserIdentity"),t=e["::create::User::identities"];return t.apply(o,arguments)},o.identities.createMany=function(){var e=r.get("UserIdentity"),t=e["::createMany::User::identities"];return t.apply(o,arguments)},o.identities.destroyAll=function(){var e=r.get("UserIdentity"),t=e["::delete::User::identities"];return t.apply(o,arguments)},o.identities.destroyById=function(){var e=r.get("UserIdentity"),t=e["::destroyById::User::identities"];return t.apply(o,arguments)},o.identities.findById=function(){var e=r.get("UserIdentity"),t=e["::findById::User::identities"];return t.apply(o,arguments)},o.identities.updateById=function(){var e=r.get("UserIdentity"),t=e["::updateById::User::identities"];return t.apply(o,arguments)},o.credentials=function(){var e=r.get("UserCredential"),t=e["::get::User::credentials"];return t.apply(o,arguments)},o.credentials.count=function(){var e=r.get("UserCredential"),t=e["::count::User::credentials"];return t.apply(o,arguments)},o.credentials.create=function(){var e=r.get("UserCredential"),t=e["::create::User::credentials"];return t.apply(o,arguments)},o.credentials.createMany=function(){var e=r.get("UserCredential"),t=e["::createMany::User::credentials"];return t.apply(o,arguments)},o.credentials.destroyAll=function(){var e=r.get("UserCredential"),t=e["::delete::User::credentials"];return t.apply(o,arguments)},o.credentials.destroyById=function(){var e=r.get("UserCredential"),t=e["::destroyById::User::credentials"];return t.apply(o,arguments)},o.credentials.findById=function(){var e=r.get("UserCredential"),t=e["::findById::User::credentials"];return t.apply(o,arguments)},o.credentials.updateById=function(){var e=r.get("UserCredential"),t=e["::updateById::User::credentials"];return t.apply(o,arguments)},o.bonsais=function(){var e=r.get("Bonsai"),t=e["::get::User::bonsais"];return t.apply(o,arguments)},o.bonsais.count=function(){var e=r.get("Bonsai"),t=e["::count::User::bonsais"];return t.apply(o,arguments)},o.bonsais.create=function(){var e=r.get("Bonsai"),t=e["::create::User::bonsais"];return t.apply(o,arguments)},o.bonsais.createMany=function(){var e=r.get("Bonsai"),t=e["::createMany::User::bonsais"];return t.apply(o,arguments)},o.bonsais.destroyAll=function(){var e=r.get("Bonsai"),t=e["::delete::User::bonsais"];return t.apply(o,arguments)},o.bonsais.destroyById=function(){var e=r.get("Bonsai"),t=e["::destroyById::User::bonsais"];return t.apply(o,arguments)},o.bonsais.findById=function(){var e=r.get("Bonsai"),t=e["::findById::User::bonsais"];return t.apply(o,arguments)},o.bonsais.updateById=function(){var e=r.get("Bonsai"),t=e["::updateById::User::bonsais"];return t.apply(o,arguments)},o}]),a.factory("UserCredential",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,n){var o=e(s+"/UserCredentials/:id",{id:"@id"},{prototype$__get__user:{url:s+"/UserCredentials/:id/user",method:"GET"},create:{url:s+"/UserCredentials",method:"POST"},createMany:{isArray:!0,url:s+"/UserCredentials",method:"POST"},patchOrCreate:{url:s+"/UserCredentials",method:"PATCH"},replaceOrCreate:{url:s+"/UserCredentials/replaceOrCreate",method:"POST"},upsertWithWhere:{url:s+"/UserCredentials/upsertWithWhere",method:"POST"},exists:{url:s+"/UserCredentials/:id/exists",method:"GET"},findById:{url:s+"/UserCredentials/:id",method:"GET"},replaceById:{url:s+"/UserCredentials/:id/replace",method:"POST"},find:{isArray:!0,url:s+"/UserCredentials",method:"GET"},findOne:{url:s+"/UserCredentials/findOne",method:"GET"},updateAll:{url:s+"/UserCredentials/update",method:"POST"},deleteById:{url:s+"/UserCredentials/:id",method:"DELETE"},count:{url:s+"/UserCredentials/count",method:"GET"},prototype$patchAttributes:{url:s+"/UserCredentials/:id",method:"PATCH"},createChangeStream:{url:s+"/UserCredentials/change-stream",method:"POST"},"::findById::User::credentials":{params:{fk:"@fk"},url:s+"/Users/:id/credentials/:fk",method:"GET"},"::destroyById::User::credentials":{params:{fk:"@fk"},url:s+"/Users/:id/credentials/:fk",method:"DELETE"},"::updateById::User::credentials":{params:{fk:"@fk"},url:s+"/Users/:id/credentials/:fk",method:"PUT"},"::get::User::credentials":{isArray:!0,url:s+"/Users/:id/credentials",method:"GET"},"::create::User::credentials":{url:s+"/Users/:id/credentials",method:"POST"},"::createMany::User::credentials":{isArray:!0,url:s+"/Users/:id/credentials",method:"POST"},"::delete::User::credentials":{url:s+"/Users/:id/credentials",method:"DELETE"},"::count::User::credentials":{url:s+"/Users/:id/credentials/count",method:"GET"}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.modelName="UserCredential",o.user=function(){var e=r.get("User"),t=e["::get::UserCredential::user"];return t.apply(o,arguments)},o}]),a.factory("UserIdentity",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,n){var o=e(s+"/UserIdentities/:id",{id:"@id"},{prototype$__get__user:{url:s+"/UserIdentities/:id/user",method:"GET"},create:{url:s+"/UserIdentities",method:"POST"},createMany:{isArray:!0,url:s+"/UserIdentities",method:"POST"},patchOrCreate:{url:s+"/UserIdentities",method:"PATCH"},replaceOrCreate:{url:s+"/UserIdentities/replaceOrCreate",method:"POST"},upsertWithWhere:{url:s+"/UserIdentities/upsertWithWhere",method:"POST"},exists:{url:s+"/UserIdentities/:id/exists",method:"GET"},findById:{url:s+"/UserIdentities/:id",method:"GET"},replaceById:{url:s+"/UserIdentities/:id/replace",method:"POST"},find:{isArray:!0,url:s+"/UserIdentities",method:"GET"},findOne:{url:s+"/UserIdentities/findOne",method:"GET"},updateAll:{url:s+"/UserIdentities/update",method:"POST"},deleteById:{url:s+"/UserIdentities/:id",method:"DELETE"},count:{url:s+"/UserIdentities/count",method:"GET"},prototype$patchAttributes:{url:s+"/UserIdentities/:id",method:"PATCH"},createChangeStream:{url:s+"/UserIdentities/change-stream",method:"POST"},"::findById::User::identities":{params:{fk:"@fk"},url:s+"/Users/:id/identities/:fk",method:"GET"},"::destroyById::User::identities":{params:{fk:"@fk"},url:s+"/Users/:id/identities/:fk",method:"DELETE"},"::updateById::User::identities":{params:{fk:"@fk"},url:s+"/Users/:id/identities/:fk",method:"PUT"},"::get::User::identities":{isArray:!0,url:s+"/Users/:id/identities",method:"GET"},"::create::User::identities":{url:s+"/Users/:id/identities",method:"POST"},"::createMany::User::identities":{isArray:!0,url:s+"/Users/:id/identities",method:"POST"},"::delete::User::identities":{url:s+"/Users/:id/identities",method:"DELETE"},"::count::User::identities":{url:s+"/Users/:id/identities/count",method:"GET"}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.modelName="UserIdentity",o.user=function(){var e=r.get("User"),t=e["::get::UserIdentity::user"];return t.apply(o,arguments)},o}]),a.factory("Bonsai",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,n){var o=e(s+"/Bonsais/:id",{id:"@id"},{create:{url:s+"/Bonsais",method:"POST"},createMany:{isArray:!0,url:s+"/Bonsais",method:"POST"},patchOrCreate:{url:s+"/Bonsais",method:"PATCH"},replaceOrCreate:{url:s+"/Bonsais/replaceOrCreate",method:"POST"},upsertWithWhere:{url:s+"/Bonsais/upsertWithWhere",method:"POST"},exists:{url:s+"/Bonsais/:id/exists",method:"GET"},findById:{url:s+"/Bonsais/:id",method:"GET"},replaceById:{url:s+"/Bonsais/:id/replace",method:"POST"},find:{isArray:!0,url:s+"/Bonsais",method:"GET"},findOne:{url:s+"/Bonsais/findOne",method:"GET"},updateAll:{url:s+"/Bonsais/update",method:"POST"},deleteById:{url:s+"/Bonsais/:id",method:"DELETE"},count:{url:s+"/Bonsais/count",method:"GET"},prototype$patchAttributes:{url:s+"/Bonsais/:id",method:"PATCH"},createChangeStream:{url:s+"/Bonsais/change-stream",method:"POST"},"::findById::User::bonsais":{params:{fk:"@fk"},url:s+"/Users/:id/bonsais/:fk",method:"GET"},"::destroyById::User::bonsais":{params:{fk:"@fk"},url:s+"/Users/:id/bonsais/:fk",method:"DELETE"},"::updateById::User::bonsais":{params:{fk:"@fk"},url:s+"/Users/:id/bonsais/:fk",method:"PUT"},"::get::User::bonsais":{isArray:!0,url:s+"/Users/:id/bonsais",method:"GET"},"::create::User::bonsais":{url:s+"/Users/:id/bonsais",method:"POST"},"::createMany::User::bonsais":{isArray:!0,url:s+"/Users/:id/bonsais",method:"POST"},"::delete::User::bonsais":{url:s+"/Users/:id/bonsais",method:"DELETE"},"::count::User::bonsais":{url:s+"/Users/:id/bonsais/count",method:"GET"}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.modelName="Bonsai",o}]),a.factory("LoopBackAuth",function(){function e(){var e=this;n.forEach(function(t){e[t]=r(t)}),this.currentUserData=null}function t(e,t,r){try{var n=s+t;null==r&&(r=""),e[n]=r}catch(o){console.log("Cannot access local/session storage:",o)}}function r(e){var t=s+e;return localStorage[t]||sessionStorage[t]||null}var n=["accessTokenId","currentUserId","rememberMe"],s="$LoopBack$";return e.prototype.save=function(){var e=this,r=this.rememberMe?localStorage:sessionStorage;n.forEach(function(n){t(r,n,e[n])})},e.prototype.setUser=function(e,t,r){this.accessTokenId=e,this.currentUserId=t,this.currentUserData=r},e.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},e.prototype.clearStorage=function(){n.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e}).config(["$httpProvider",function(e){e.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","LoopBackAuth",function(e,t){return{request:function(s){var a=n(s.url);if(a&&a!==i)return s;if(t.accessTokenId)s.headers[o]=t.accessTokenId;else if(s.__isGetCurrentUser__){var d={body:{error:{status:401}},status:401,config:s,headers:function(){return r}};return e.reject(d)}return s||e.when(s)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(e){o=e},this.getAuthHeader=function(){return o},this.setUrlBase=function(e){s=e,i=n(s)||location.host},this.getUrlBase=function(){return s},this.$get=["$resource",function(e){var t=function(t,r,n){var s=e(t,r,n);return s.prototype.$save=function(e,t){var r=s.upsert.call(this,{},this,e,t);return r.$promise||r},s};return t.getUrlBase=function(){return s},t.getAuthHeader=function(){return o},t}]})}(window,window.angular),angular.module("bonsaiManagerWebApp").factory("AuthService",["User","$q","$rootScope","ngDialog",function(e,t,r,n){function s(t){return e.login(t).$promise.then(function(e){r.currentUser={id:e.user.id,tokenId:e.id,username:t.username},r.$broadcast("login:Successful")},function(e){var t='                            <div class="ngdialog-message">                            <div><h3>Login Unsuccessful</h3></div><div><p>'+e.data.error.message+"</p><p>"+e.data.error.name+'</p></div><div class="ngdialog-buttons">                                <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click=confirm("OK")>OK</button>                            </div>';n.openConfirm({template:t,plain:"true"})})}function o(){return r.currentUser}function i(){return r.currentUser.username}function a(){return e.logout().$promise.then(function(){r.currentUser=null,r.$broadcast("logout")})}function d(t){return e.create({username:t.username,email:t.email,password:t.password}).$promise.then(function(e){},function(e){var t='                <div class="ngdialog-message">                <div><h3>Registration Unsuccessful</h3></div><div><p>'+e.data.error.message+"</p><p>"+e.data.error.name+"</p></div>";n.openConfirm({template:t,plain:"true"})})}function u(t){return e.getCurrent(function(e){r.currentUser={id:e.id,tokenId:t,email:e.email}})}return{login:s,logout:a,register:d,refresh:u,isAuthenticated:o,getUsername:i}}]).factory("$localStorage",["$window",function(e){return{store:function(t,r){e.localStorage[t]=r},get:function(t,r){return e.localStorage[t]||r},remove:function(t){e.localStorage.removeItem(t)},storeObject:function(t,r){e.localStorage[t]=JSON.stringify(r)},getObject:function(t,r){return JSON.parse(e.localStorage[t]||r)}}}]).factory("$user",["User",function(e){var t={};return t.load=function(){e.findById({id:"me"},function(e){t.data=e})},t.load(),t}]).factory("$facebookLogin",["$user",function(e){return function(){var t="http://localhost:3000/auth/facebook",r=window.open(t,"_self","location=no");if(window.cordova)r.addEventListener("loadstop",function(t){t.url.indexOf("/auth/facebook/callback")!==-1&&(r.close(),e.load())});else var n=setInterval(function(){r.closed&&(e.load(),clearInterval(n))},100)}}]).factory("$googleLogin",["$user",function(e){return function(){var t="https://bonsai-manager.mybluemix.net/auth/google",r=window.open(t,"_self","location=no");if(window.cordova)r.addEventListener("loadstop",function(t){t.url.indexOf("/auth/google/callback")!==-1&&(r.close(),e.load())});else var n=setInterval(function(){r.closed&&(e.load(),clearInterval(n))},100)}}]).factory("$twitterLogin",["$user",function(e){return function(){var t="https://bonsai-manager.mybluemix.net/auth/twitter",r=window.open(t,"_self","location=no");if(window.cordova)r.addEventListener("loadstop",function(t){t.url.indexOf("/auth/twitter/callback")!==-1&&(r.close(),e.load())});else var n=setInterval(function(){r.closed&&(e.load(),clearInterval(n))},100)}}]),function(){angular.module("bonsaiManagerWebApp").factory("httpInterceptor",["$q","$rootScope","$log",function(e,t,r){var n=0;return{request:function(r){return n++,t.$broadcast("loader_show"),r||e.when(r)},response:function(r){return 0===--n&&t.$broadcast("loader_hide"),r||e.when(r)},responseError:function(r){return--n||t.$broadcast("loader_hide"),e.reject(r)}}}]).config(["$httpProvider",function(e){e.interceptors.push("httpInterceptor")}])}();