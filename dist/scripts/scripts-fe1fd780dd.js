"use strict";function LogoutCtrl(e,t){t.logout().then(function(){e.go("app")})}LogoutCtrl.$inject=["$state","AuthService"],angular.module("bonsaiManagerWebApp",["ngResource","ngDialog","ui.router","lbServices","bonsaiManagerWebApp.services"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/",views:{sidebar:{templateUrl:"views/sidebar.html",controller:"SidebarCtrl",controllerAs:"sidebar"},content:{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}}}).state("app.newedit",{url:"newedit/:id",views:{"content@":{templateUrl:"views/newedit.html",controller:"NewEditCtrl",controllerAs:"newedit"}}}).state("app.list",{url:"list",views:{"content@":{templateUrl:"views/list.html",controller:"ListCtrl",controllerAs:"list"}}}).state("app.bonsaidetail",{url:"detail/:id",views:{"content@":{templateUrl:"views/bonsaidetail.html",controller:"BonsaiDetailCtrl",controllerAs:"detail"}}}),t.otherwise("/")}]).config(["$httpProvider",function(e){e.interceptors.push(function(){return{request:function(e){return"/"===e.url.charAt(0)&&(e.url="https://bonsai-manager.mybluemix.net"+e.url,console.log("interceptor req url: ",e.url),e.withCredentials=!0),e}}})}]).run(["$rootScope","$state","LoopBackAuth","AuthService",function(e,t,r,s){e.$on("$stateChangeStart",function(s,n,o){n.authenticate&&!r.accessTokenId&&(s.preventDefault(),e.returnTo={state:n,params:o},t.go("app"))}),r.accessTokenId&&!e.currentUser&&s.refresh(r.accessTokenId)}]),function(){function e(e,t,r,s,n,o){function i(){l.loggedIn=!1,l.username="",o.isAuthenticated()&&(l.loggedIn=!0,l.username=o.getUsername())}function a(){n.open({template:"views/login.html",scope:e,className:"ngdialog-theme-default",controller:"LoginCtrl"})}function d(){o.logout(),l.loggedIn=!1,l.username=""}function u(e){return t.is(e)}var l=this;l.openLogin=a,l.logOut=d,l.stateis=u,r.$on("login:Successful",function(){l.loggedIn=o.isAuthenticated(),l.username=o.getUsername()}),r.$on("registration:Successful",function(){l.loggedIn=o.isAuthenticated(),l.username=o.getUsername()}),e.$watch("currentUser.id",function(e){e&&(console.log("value",e),l.loggedIn=!0,l.username=o.getUsername())}),i()}e.$inject=["$scope","$state","$rootScope","$log","ngDialog","AuthService"],angular.module("bonsaiManagerWebApp").controller("SidebarCtrl",e)}(),function(){function e(e,t,r){function s(){n.loggedIn=!1,n.username="",r.isAuthenticated()&&(n.loggedIn=!0,n.username=r.getUsername())}var n=this;t.$on("login:Successful",function(){n.loggedIn=r.isAuthenticated(),n.username=r.getUsername()}),t.$on("logout",function(){n.loggedIn=!1,n.username=""}),e.$watch("currentUser.id",function(e){e&&(console.log("value",e),n.loggedIn=!0,n.username=r.getUsername())}),s()}e.$inject=["$scope","$rootScope","AuthService"],angular.module("bonsaiManagerWebApp").controller("MainCtrl",e)}(),function(){function e(e,t,r,s,n,o,i,a){function d(){e.loggedIn=!1,e.username="",e.loginData=i.getObject("userinfo","{}"),console.log("user",e.loginData),e.loginData&&(e.loggedIn=!0)}e.doLogin=function(){console.log("login"),e.rememberMe&&i.storeObject("userinfo",e.loginData),a.login(e.loginData),o.close()},e.openRegister=function(){console.log("register"),o.open({template:"views/register.html",scope:e,className:"ngdialog-theme-default",controller:"RegisterCtrl"})},d()}e.$inject=["$scope","$user","$facebookLogin","$googleLogin","$twitterLogin","ngDialog","$localStorage","AuthService"],angular.module("bonsaiManagerWebApp").controller("LoginCtrl",e)}(),angular.module("bonsaiManagerWebApp").controller("LogoutCtrl",LogoutCtrl),function(){function e(e,t,r,s){e.doRegister=function(){console.log("regoister",e.registration),t.register(e.registration),r.close()}}e.$inject=["$scope","AuthService","ngDialog","$localStorage"],angular.module("bonsaiManagerWebApp").controller("RegisterCtrl",e)}(),function(){function e(e,t,r,s,n,o,i){function a(){l.loggedIn=!1,l.editMode=!1,i.isAuthenticated()&&s.id&&o.findById({id:s.id}).$promise.then(function(e){l.bonsai=e,l.editMode=!0},function(e){l.message="Error: "+e.status+" "+e.statusText})}function d(){if(l.editMode){console.log("update",l.bonsai);var e={name:"test",species:"test",age:10,height:20,diameter:30,style:"test",pot:"sdf",id:"599f1880f43edb092c8e840a",userId:"599bc7468cb1c005ca951c12"};o.upsert(e).$promise.then(function(e){console.log("bonsai saved",e),r.go("app.list")})}else console.log("create",l.bonsai),o.create(l.bonsai).$promise.then(function(e){console.log("bonsai saved",e),r.go("app.list")})}function u(){r.go("app.list")}var l=this;l.createUpdateBonsai=d,l.cancel=u,t.$on("login:Successful",function(){l.loggedIn=i.isAuthenticated(),l.username=i.getUsername()}),t.$on("logout",function(){l.loggedIn=!1,l.username=""}),e.$watch("currentUser.id",function(e){e&&(l.loggedIn=!0)}),a()}e.$inject=["$scope","$rootScope","$state","$stateParams","User","Bonsai","AuthService"],angular.module("bonsaiManagerWebApp").controller("NewEditCtrl",e)}(),function(){function e(e,t,r,s,n,o,i){function a(){u.loggedIn=!1,u.username="",console.log("init",i.isAuthenticated()),i.isAuthenticated()&&(u.loggedIn=!0,u.username=i.getUsername())}function d(){o.openConfirm({template:'<p>Are you sure you want to delete selected Bonsai?</p><div><button type="button" class="btn btn-default" ng-click="closeThisDialog(0)">No&nbsp;<button type="button" class="btn btn-primary pull-right" ng-click="confirm(1)">Yes</button></div>',plain:!0,className:"ngdialog-theme-default"}).then(function(e){console.log("create",u.bonsai),n["delete"](u.bonsai).$promise.then(function(e){console.log("bonsai deleted",e),r.go("app.list")})},function(e){})}var u=this;u.deleteBonsai=d,t.$watch("currentUser.id",function(e){e&&(u.loggedIn=!0,n.findById({id:s.id}).$promise.then(function(e){u.bonsai=e},function(e){u.message="Error: "+e.status+" "+e.statusText}))}),a()}e.$inject=["$rootScope","$scope","$state","$stateParams","Bonsai","ngDialog","AuthService"],angular.module("bonsaiManagerWebApp").controller("BonsaiDetailCtrl",e)}(),function(){function e(e,t,r,s){function n(){i.loggedIn=!1,i.username="",s.isAuthenticated()&&(i.loggedIn=!0,i.username=s.getUsername(),console.log("currentUser",i.username))}function o(e){console.log("bonsai id",e),e&&$state.go("app.bonsaidetail",{id:e})}var i=this;i.bonsaiDetail=o,e.$on("login:Successful",function(){i.loggedIn=s.isAuthenticated(),i.username=s.getUsername()}),e.$on("logout",function(){i.loggedIn=!1,i.username=""}),t.$watch("currentUser.id",function(t){t&&(i.loggedIn=!0,console.log("value",e.currentUser),r.bonsais({id:"me"}).$promise.then(function(e){i.bonsais=e,console.log("bonsais",i.bonsais)},function(e){i.message="Error: "+e.status+" "+e.statusText}))}),n()}e.$inject=["$rootScope","$scope","User","AuthService"],angular.module("bonsaiManagerWebApp").controller("ListCtrl",e)}(),"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="lbServices"),function(e,t,r){function s(e){var t=e.match(/^(?:https?:)?\/\/([^\/]+)/);return t?t[1]:null}var n="/api",o="authorization",i=s(n)||location.host,a=t.module("lbServices",["ngResource"]);a.factory("User",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,s){var o=e(n+"/Users/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"PUT"},prototype$__findById__identities:{params:{fk:"@fk"},url:n+"/Users/:id/identities/:fk",method:"GET"},prototype$__destroyById__identities:{params:{fk:"@fk"},url:n+"/Users/:id/identities/:fk",method:"DELETE"},prototype$__updateById__identities:{params:{fk:"@fk"},url:n+"/Users/:id/identities/:fk",method:"PUT"},prototype$__findById__credentials:{params:{fk:"@fk"},url:n+"/Users/:id/credentials/:fk",method:"GET"},prototype$__destroyById__credentials:{params:{fk:"@fk"},url:n+"/Users/:id/credentials/:fk",method:"DELETE"},prototype$__updateById__credentials:{params:{fk:"@fk"},url:n+"/Users/:id/credentials/:fk",method:"PUT"},prototype$__findById__bonsais:{params:{fk:"@fk"},url:n+"/Users/:id/bonsais/:fk",method:"GET"},prototype$__destroyById__bonsais:{params:{fk:"@fk"},url:n+"/Users/:id/bonsais/:fk",method:"DELETE"},prototype$__updateById__bonsais:{params:{fk:"@fk"},url:n+"/Users/:id/bonsais/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:n+"/Users/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:n+"/Users/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:n+"/Users/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:n+"/Users/:id/accessTokens/count",method:"GET"},prototype$__get__identities:{isArray:!0,url:n+"/Users/:id/identities",method:"GET"},prototype$__create__identities:{url:n+"/Users/:id/identities",method:"POST"},prototype$__delete__identities:{url:n+"/Users/:id/identities",method:"DELETE"},prototype$__count__identities:{url:n+"/Users/:id/identities/count",method:"GET"},prototype$__get__credentials:{isArray:!0,url:n+"/Users/:id/credentials",method:"GET"},prototype$__create__credentials:{url:n+"/Users/:id/credentials",method:"POST"},prototype$__delete__credentials:{url:n+"/Users/:id/credentials",method:"DELETE"},prototype$__count__credentials:{url:n+"/Users/:id/credentials/count",method:"GET"},prototype$__get__bonsais:{isArray:!0,url:n+"/Users/:id/bonsais",method:"GET"},prototype$__create__bonsais:{url:n+"/Users/:id/bonsais",method:"POST"},prototype$__delete__bonsais:{url:n+"/Users/:id/bonsais",method:"DELETE"},prototype$__count__bonsais:{url:n+"/Users/:id/bonsais/count",method:"GET"},create:{url:n+"/Users",method:"POST"},createMany:{isArray:!0,url:n+"/Users",method:"POST"},patchOrCreate:{url:n+"/Users",method:"PATCH"},replaceOrCreate:{url:n+"/Users/replaceOrCreate",method:"POST"},upsertWithWhere:{url:n+"/Users/upsertWithWhere",method:"POST"},exists:{url:n+"/Users/:id/exists",method:"GET"},findById:{url:n+"/Users/:id",method:"GET"},replaceById:{url:n+"/Users/:id/replace",method:"POST"},find:{isArray:!0,url:n+"/Users",method:"GET"},findOne:{url:n+"/Users/findOne",method:"GET"},updateAll:{url:n+"/Users/update",method:"POST"},deleteById:{url:n+"/Users/:id",method:"DELETE"},count:{url:n+"/Users/count",method:"GET"},prototype$patchAttributes:{url:n+"/Users/:id",method:"PATCH"},createChangeStream:{url:n+"/Users/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(e){var r=e.data;return t.setUser(r.id,r.userId,r.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:n+"/Users/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource},responseError:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:n+"/Users/logout",method:"POST"},prototype$verify:{url:n+"/Users/:id/verify",method:"POST"},confirm:{url:n+"/Users/confirm",method:"GET"},resetPassword:{url:n+"/Users/reset",method:"POST"},changePassword:{url:n+"/Users/change-password",method:"POST"},setPassword:{url:n+"/Users/reset-password",method:"POST"},"::get::UserCredential::user":{url:n+"/UserCredentials/:id/user",method:"GET"},"::get::UserIdentity::user":{url:n+"/UserIdentities/:id/user",method:"GET"},getCurrent:{url:n+"/Users/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource},responseError:function(e){return t.clearUser(),t.clearStorage(),s.reject(e)}},__isGetCurrentUser__:!0}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.getCachedCurrent=function(){var e=t.currentUserData;return e?new o(e):null},o.isAuthenticated=function(){return null!=this.getCurrentId()},o.getCurrentId=function(){return t.currentUserId},o.modelName="User",o.identities=function(){var e=r.get("UserIdentity"),t=e["::get::User::identities"];return t.apply(o,arguments)},o.identities.count=function(){var e=r.get("UserIdentity"),t=e["::count::User::identities"];return t.apply(o,arguments)},o.identities.create=function(){var e=r.get("UserIdentity"),t=e["::create::User::identities"];return t.apply(o,arguments)},o.identities.createMany=function(){var e=r.get("UserIdentity"),t=e["::createMany::User::identities"];return t.apply(o,arguments)},o.identities.destroyAll=function(){var e=r.get("UserIdentity"),t=e["::delete::User::identities"];return t.apply(o,arguments)},o.identities.destroyById=function(){var e=r.get("UserIdentity"),t=e["::destroyById::User::identities"];return t.apply(o,arguments)},o.identities.findById=function(){var e=r.get("UserIdentity"),t=e["::findById::User::identities"];return t.apply(o,arguments)},o.identities.updateById=function(){var e=r.get("UserIdentity"),t=e["::updateById::User::identities"];return t.apply(o,arguments)},o.credentials=function(){var e=r.get("UserCredential"),t=e["::get::User::credentials"];return t.apply(o,arguments)},o.credentials.count=function(){var e=r.get("UserCredential"),t=e["::count::User::credentials"];return t.apply(o,arguments)},o.credentials.create=function(){var e=r.get("UserCredential"),t=e["::create::User::credentials"];return t.apply(o,arguments)},o.credentials.createMany=function(){var e=r.get("UserCredential"),t=e["::createMany::User::credentials"];return t.apply(o,arguments)},o.credentials.destroyAll=function(){var e=r.get("UserCredential"),t=e["::delete::User::credentials"];return t.apply(o,arguments)},o.credentials.destroyById=function(){var e=r.get("UserCredential"),t=e["::destroyById::User::credentials"];return t.apply(o,arguments)},o.credentials.findById=function(){var e=r.get("UserCredential"),t=e["::findById::User::credentials"];return t.apply(o,arguments)},o.credentials.updateById=function(){var e=r.get("UserCredential"),t=e["::updateById::User::credentials"];return t.apply(o,arguments)},o.bonsais=function(){var e=r.get("Bonsai"),t=e["::get::User::bonsais"];return t.apply(o,arguments)},o.bonsais.count=function(){var e=r.get("Bonsai"),t=e["::count::User::bonsais"];return t.apply(o,arguments)},o.bonsais.create=function(){var e=r.get("Bonsai"),t=e["::create::User::bonsais"];return t.apply(o,arguments)},o.bonsais.createMany=function(){var e=r.get("Bonsai"),t=e["::createMany::User::bonsais"];return t.apply(o,arguments)},o.bonsais.destroyAll=function(){var e=r.get("Bonsai"),t=e["::delete::User::bonsais"];return t.apply(o,arguments)},o.bonsais.destroyById=function(){var e=r.get("Bonsai"),t=e["::destroyById::User::bonsais"];return t.apply(o,arguments)},o.bonsais.findById=function(){var e=r.get("Bonsai"),t=e["::findById::User::bonsais"];return t.apply(o,arguments)},o.bonsais.updateById=function(){var e=r.get("Bonsai"),t=e["::updateById::User::bonsais"];return t.apply(o,arguments)},o}]),a.factory("UserCredential",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,s){var o=e(n+"/UserCredentials/:id",{id:"@id"},{prototype$__get__user:{url:n+"/UserCredentials/:id/user",method:"GET"},create:{url:n+"/UserCredentials",method:"POST"},createMany:{isArray:!0,url:n+"/UserCredentials",method:"POST"},patchOrCreate:{url:n+"/UserCredentials",method:"PATCH"},replaceOrCreate:{url:n+"/UserCredentials/replaceOrCreate",method:"POST"},upsertWithWhere:{url:n+"/UserCredentials/upsertWithWhere",method:"POST"},exists:{url:n+"/UserCredentials/:id/exists",method:"GET"},findById:{url:n+"/UserCredentials/:id",method:"GET"},replaceById:{url:n+"/UserCredentials/:id/replace",method:"POST"},find:{isArray:!0,url:n+"/UserCredentials",method:"GET"},findOne:{url:n+"/UserCredentials/findOne",method:"GET"},updateAll:{url:n+"/UserCredentials/update",method:"POST"},deleteById:{url:n+"/UserCredentials/:id",method:"DELETE"},count:{url:n+"/UserCredentials/count",method:"GET"},prototype$patchAttributes:{url:n+"/UserCredentials/:id",method:"PATCH"},createChangeStream:{url:n+"/UserCredentials/change-stream",method:"POST"},"::findById::User::credentials":{params:{fk:"@fk"},url:n+"/Users/:id/credentials/:fk",method:"GET"},"::destroyById::User::credentials":{params:{fk:"@fk"},url:n+"/Users/:id/credentials/:fk",method:"DELETE"},"::updateById::User::credentials":{params:{fk:"@fk"},url:n+"/Users/:id/credentials/:fk",method:"PUT"},"::get::User::credentials":{isArray:!0,url:n+"/Users/:id/credentials",method:"GET"},"::create::User::credentials":{url:n+"/Users/:id/credentials",method:"POST"},"::createMany::User::credentials":{isArray:!0,url:n+"/Users/:id/credentials",method:"POST"},"::delete::User::credentials":{url:n+"/Users/:id/credentials",method:"DELETE"},"::count::User::credentials":{url:n+"/Users/:id/credentials/count",method:"GET"}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.modelName="UserCredential",o.user=function(){var e=r.get("User"),t=e["::get::UserCredential::user"];return t.apply(o,arguments)},o}]),a.factory("UserIdentity",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,s){var o=e(n+"/UserIdentities/:id",{id:"@id"},{prototype$__get__user:{url:n+"/UserIdentities/:id/user",method:"GET"},create:{url:n+"/UserIdentities",method:"POST"},createMany:{isArray:!0,url:n+"/UserIdentities",method:"POST"},patchOrCreate:{url:n+"/UserIdentities",method:"PATCH"},replaceOrCreate:{url:n+"/UserIdentities/replaceOrCreate",method:"POST"},upsertWithWhere:{url:n+"/UserIdentities/upsertWithWhere",method:"POST"},exists:{url:n+"/UserIdentities/:id/exists",method:"GET"},findById:{url:n+"/UserIdentities/:id",method:"GET"},replaceById:{url:n+"/UserIdentities/:id/replace",method:"POST"},find:{isArray:!0,url:n+"/UserIdentities",method:"GET"},findOne:{url:n+"/UserIdentities/findOne",method:"GET"},updateAll:{url:n+"/UserIdentities/update",method:"POST"},deleteById:{url:n+"/UserIdentities/:id",method:"DELETE"},count:{url:n+"/UserIdentities/count",method:"GET"},prototype$patchAttributes:{url:n+"/UserIdentities/:id",method:"PATCH"},createChangeStream:{url:n+"/UserIdentities/change-stream",method:"POST"},"::findById::User::identities":{params:{fk:"@fk"},url:n+"/Users/:id/identities/:fk",method:"GET"},"::destroyById::User::identities":{params:{fk:"@fk"},url:n+"/Users/:id/identities/:fk",method:"DELETE"},"::updateById::User::identities":{params:{fk:"@fk"},url:n+"/Users/:id/identities/:fk",method:"PUT"},"::get::User::identities":{isArray:!0,url:n+"/Users/:id/identities",method:"GET"},"::create::User::identities":{url:n+"/Users/:id/identities",method:"POST"},"::createMany::User::identities":{isArray:!0,url:n+"/Users/:id/identities",method:"POST"},"::delete::User::identities":{url:n+"/Users/:id/identities",method:"DELETE"},"::count::User::identities":{url:n+"/Users/:id/identities/count",method:"GET"}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.modelName="UserIdentity",o.user=function(){var e=r.get("User"),t=e["::get::UserIdentity::user"];return t.apply(o,arguments)},o}]),a.factory("Bonsai",["LoopBackResource","LoopBackAuth","$injector","$q",function(e,t,r,s){var o=e(n+"/Bonsais/:id",{id:"@id"},{create:{url:n+"/Bonsais",method:"POST"},createMany:{isArray:!0,url:n+"/Bonsais",method:"POST"},patchOrCreate:{url:n+"/Bonsais",method:"PATCH"},replaceOrCreate:{url:n+"/Bonsais/replaceOrCreate",method:"POST"},upsertWithWhere:{url:n+"/Bonsais/upsertWithWhere",method:"POST"},exists:{url:n+"/Bonsais/:id/exists",method:"GET"},findById:{url:n+"/Bonsais/:id",method:"GET"},replaceById:{url:n+"/Bonsais/:id/replace",method:"POST"},find:{isArray:!0,url:n+"/Bonsais",method:"GET"},findOne:{url:n+"/Bonsais/findOne",method:"GET"},updateAll:{url:n+"/Bonsais/update",method:"POST"},deleteById:{url:n+"/Bonsais/:id",method:"DELETE"},count:{url:n+"/Bonsais/count",method:"GET"},prototype$patchAttributes:{url:n+"/Bonsais/:id",method:"PATCH"},createChangeStream:{url:n+"/Bonsais/change-stream",method:"POST"},"::findById::User::bonsais":{params:{fk:"@fk"},url:n+"/Users/:id/bonsais/:fk",method:"GET"},"::destroyById::User::bonsais":{params:{fk:"@fk"},url:n+"/Users/:id/bonsais/:fk",method:"DELETE"},"::updateById::User::bonsais":{params:{fk:"@fk"},url:n+"/Users/:id/bonsais/:fk",method:"PUT"},"::get::User::bonsais":{isArray:!0,url:n+"/Users/:id/bonsais",method:"GET"},"::create::User::bonsais":{url:n+"/Users/:id/bonsais",method:"POST"},"::createMany::User::bonsais":{isArray:!0,url:n+"/Users/:id/bonsais",method:"POST"},"::delete::User::bonsais":{url:n+"/Users/:id/bonsais",method:"DELETE"},"::count::User::bonsais":{url:n+"/Users/:id/bonsais/count",method:"GET"}});return o.upsert=o.patchOrCreate,o.updateOrCreate=o.patchOrCreate,o.patchOrCreateWithWhere=o.upsertWithWhere,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.updateAttributes=o.prototype$patchAttributes,o.modelName="Bonsai",o}]),a.factory("LoopBackAuth",function(){function e(){var e=this;s.forEach(function(t){e[t]=r(t)}),this.currentUserData=null}function t(e,t,r){try{var s=n+t;null==r&&(r=""),e[s]=r}catch(o){console.log("Cannot access local/session storage:",o)}}function r(e){var t=n+e;return localStorage[t]||sessionStorage[t]||null}var s=["accessTokenId","currentUserId","rememberMe"],n="$LoopBack$";return e.prototype.save=function(){var e=this,r=this.rememberMe?localStorage:sessionStorage;s.forEach(function(s){t(r,s,e[s])})},e.prototype.setUser=function(e,t,r){this.accessTokenId=e,this.currentUserId=t,this.currentUserData=r},e.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},e.prototype.clearStorage=function(){s.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e}).config(["$httpProvider",function(e){e.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","LoopBackAuth",function(e,t){return{request:function(n){var a=s(n.url);if(a&&a!==i)return n;if(t.accessTokenId)n.headers[o]=t.accessTokenId;else if(n.__isGetCurrentUser__){var d={body:{error:{status:401}},status:401,config:n,headers:function(){return r}};return e.reject(d)}return n||e.when(n)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(e){o=e},this.getAuthHeader=function(){return o},this.setUrlBase=function(e){n=e,i=s(n)||location.host},this.getUrlBase=function(){return n},this.$get=["$resource",function(e){var t=function(t,r,s){var n=e(t,r,s);return n.prototype.$save=function(e,t){var r=n.upsert.call(this,{},this,e,t);return r.$promise||r},n};return t.getUrlBase=function(){return n},t.getAuthHeader=function(){return o},t}]})}(window,window.angular),angular.module("bonsaiManagerWebApp.services",[]).factory("$user",["User",function(e){var t={};return t.load=function(){e.findById({id:"me"},function(e){t.data=e})},t.load(),t}]).factory("$facebookLogin",["$user",function(e){return function(){var t="http://localhost:3000/auth/facebook",r=window.open(t,"_self","location=no");if(window.cordova)r.addEventListener("loadstop",function(t){t.url.indexOf("/auth/facebook/callback")!==-1&&(r.close(),e.load())});else var s=setInterval(function(){r.closed&&(e.load(),clearInterval(s))},100)}}]).factory("$googleLogin",["$user",function(e){return function(){var t="https://bonsai-manager.mybluemix.net/auth/google",r=window.open(t,"_self","location=no");if(window.cordova)r.addEventListener("loadstop",function(t){t.url.indexOf("/auth/google/callback")!==-1&&(r.close(),e.load())});else var s=setInterval(function(){r.closed&&(e.load(),clearInterval(s))},100)}}]).factory("$twitterLogin",["$user",function(e){return function(){var t="https://bonsai-manager.mybluemix.net/auth/twitter",r=window.open(t,"_self","location=no");if(window.cordova)r.addEventListener("loadstop",function(t){t.url.indexOf("/auth/twitter/callback")!==-1&&(r.close(),e.load())});else var s=setInterval(function(){r.closed&&(e.load(),clearInterval(s))},100)}}]),angular.module("bonsaiManagerWebApp").factory("AuthService",["User","$q","$rootScope","ngDialog",function(e,t,r,s){function n(t){return e.login(t).$promise.then(function(e){r.currentUser={id:e.user.id,tokenId:e.id,username:t.username},r.$broadcast("login:Successful")},function(e){var t='                            <div class="ngdialog-message">                            <div><h3>Login Unsuccessful</h3></div><div><p>'+e.data.error.message+"</p><p>"+e.data.error.name+'</p></div><div class="ngdialog-buttons">                                <button type="button" class="ngdialog-button ngdialog-button-primary" ng-click=confirm("OK")>OK</button>                            </div>';s.openConfirm({template:t,plain:"true"})})}function o(){return r.currentUser}function i(){return r.currentUser.username}function a(){return e.logout().$promise.then(function(){r.currentUser=null,r.$broadcast("logout")})}function d(t){return e.create({username:t.username,email:t.email,password:t.password}).$promise.then(function(e){},function(e){var t='                <div class="ngdialog-message">                <div><h3>Registration Unsuccessful</h3></div><div><p>'+e.data.error.message+"</p><p>"+e.data.error.name+"</p></div>";s.openConfirm({template:t,plain:"true"})})}function u(t){return e.getCurrent(function(e){r.currentUser={id:e.id,tokenId:t,email:e.email}})}return{login:n,logout:a,register:d,refresh:u,isAuthenticated:o,getUsername:i}}]).factory("$localStorage",["$window",function(e){return{store:function(t,r){e.localStorage[t]=r},get:function(t,r){return e.localStorage[t]||r},remove:function(t){e.localStorage.removeItem(t)},storeObject:function(t,r){e.localStorage[t]=JSON.stringify(r)},getObject:function(t,r){return JSON.parse(e.localStorage[t]||r)}}}]);